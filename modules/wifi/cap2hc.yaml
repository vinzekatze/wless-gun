description: |- 
  Вытаскивает хендшейки их cap в понятный современному hashcat формат для режима 22000

  Сохранит hc22000 в директории запуска!!!

tags:
  - cap to hc22000
  - fix for hashcat

arguments:
  input:
    description: файлы формата .cap
    replacer: '#filename#'
    multiple: true

mode:
  format:
    input: '{!r}'
  loop: input

shell: bash
script: >-
  filename=#filename#;
  aircrack-ng $filename -J './__temp.hash';
  hcxhash2cap --hccap './__temp.hash.hccap' -c './__temp.cap' >/dev/null;
  hcxpcapngtool '__temp.cap' -o $(basename "$filename" ".${filename##*.}").hc22000 1>/dev/null;
  rm './__temp.hash.hccap' './__temp.cap' 2>/dev/null;
  hcxhashtool -i $(basename "$filename" ".${filename##*.}").hc22000 --info=stdout;

  